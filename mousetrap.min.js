/* mousetrap v1.2 craig.is/killing/mice */
(function(){var d={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},z={"~":"`","!":"1","@":"2","#":"3","$":"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta","return":"enter",escape:"esc"},A,j={},n={},t={},h,a=false,D=false;for(var u=1;u<20;++u){d[111+u]="f"+u}for(u=0;u<=9;++u){d[u+96]=u}function w(i,E,F){if(i.addEventListener){i.addEventListener(E,F,false);return}i.attachEvent("on"+E,F)}function x(i){if(i.type=="keypress"){return String.fromCharCode(i.which)}if(d[i.which]){return d[i.which]}if(k[i.which]){return k[i.which]}return String.fromCharCode(i.which).toLowerCase()}function m(E,i){return E.sort().join(",")===i.sort().join(",")}function b(E){E=E||{};var F=false,i;for(i in t){if(E[i]){F=true;continue}t[i]=0}if(!F){D=false}}function p(I,L,J,G,K){var F,M,H=[],E=J.type;if(!j[I]){return[]}if(E=="keyup"&&r(I)){L=[I]}for(F=0;F<j[I].length;++F){M=j[I][F];if(M.seq&&t[M.seq]!=M.level){continue}if(E!=M.action){continue}if((E=="keypress"&&!J.metaKey&&!J.ctrlKey)||m(L,M.modifiers)){if(G&&M.combo==K){j[I].splice(F,1)}H.push(M)}}return H}function f(E){var i=[];if(E.shiftKey){i.push("shift")}if(E.altKey){i.push("alt")}if(E.ctrlKey){i.push("ctrl")}if(E.metaKey){i.push("meta")}return i}function o(F,E,i){if(g.stopCallback(E,E.target||E.srcElement,i)){return}if(F(E,i)===false){if(E.preventDefault){E.preventDefault()}if(E.stopPropagation){E.stopPropagation()}E.returnValue=false;E.cancelBubble=true}}function c(H,J){var G=p(H,f(J),J),F,E={},I=false;for(F=0;F<G.length;++F){if(G[F].seq){I=true;E[G[F].seq]=1;o(G[F].callback,J,G[F].combo);continue}if(!I&&!D){o(G[F].callback,J,G[F].combo)}}if(J.type==D&&!r(H)){b(E)}}function y(E){if(typeof E.which!=="number"){E.which=E.keyCode}var i=x(E);if(!i){return}if(E.type=="keyup"&&a==i){a=false;return}c(i,E)}function r(i){return i=="shift"||i=="ctrl"||i=="alt"||i=="meta"}function C(){clearTimeout(h);h=setTimeout(b,1000)}function e(){if(!A){A={};for(var i in d){if(i>95&&i<112){continue}if(d.hasOwnProperty(i)){A[d[i]]=i}}}return A}function q(E,i,F){if(!F){F=e()[E]?"keydown":"keypress"}if(F=="keypress"&&i.length){F="keydown"}return F}function B(I,G,K,H){t[I]=0;if(!H){H=q(G[0],[])}var J=function(i){D=H;++t[I];C()},F=function(i){o(K,i,I);if(H!=="keyup"){a=x(i)}setTimeout(b,10)},E;for(E=0;E<G.length;++E){v(G[E],E<G.length-1?J:F,H,I,E)}}function v(J,M,H,F,E){J=J.replace(/\s+/g," ");var G=J.split(" "),I,L,N,K=[];if(G.length>1){B(J,G,M,H);return}N=J==="+"?["+"]:J.split("+");for(I=0;I<N.length;++I){L=N[I];if(s[L]){L=s[L]}if(H&&H!="keypress"&&z[L]){L=z[L];K.push("shift")}if(r(L)){K.push(L)}}H=q(L,K,H);if(!j[L]){j[L]=[]}p(L,K,{type:H},!F,J);j[L][F?"unshift":"push"]({callback:M,modifiers:K,action:H,seq:F,level:E,combo:J})}function l(F,H,G){for(var E=0;E<F.length;++E){v(F[E],H,G)}}w(document,"keypress",y);w(document,"keydown",y);w(document,"keyup",y);var g={bind:function(E,H,F,i){var G=function(J,I){H.call(i,J,I)};l(E instanceof Array?E:[E],i?G:H,F);n[E+":"+F]=i?G:H;return this},unbind:function(i,E){if(n[i+":"+E]){delete n[i+":"+E];this.bind(i,function(){},E)}return this},trigger:function(i,E){n[i+":"+E]();return this},reset:function(){j={};n={};return this},stopCallback:function(F,i,E){if((" "+i.className+" ").indexOf(" mousetrap ")>-1){return false}return i.tagName=="INPUT"||i.tagName=="SELECT"||i.tagName=="TEXTAREA"||(i.contentEditable&&i.contentEditable=="true")}};window.Mousetrap=g;if(typeof define==="function"&&define.amd){define("mousetrap",function(){return g})}})();